#!/bin/sh

REF=$1
if [ -z "$REF" ]; then
	REF=origin/master
fi

for sha1 in $(git rev-list --reverse ${REF}..HEAD); do
	git --no-pager log --oneline --no-decorate -1 $sha1
	git format-patch -k -1 --no-binary --stdout --no-renames $sha1 |
	/mnt/sources/clones/infrastructure/git-tools/scripts/checkpatches.sh -
done
